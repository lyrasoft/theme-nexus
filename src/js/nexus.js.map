{"version":3,"sources":["nexus.ts"],"names":[],"mappings":"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","file":"nexus.js","sourcesContent":["import { domready, useFormAsync, useMacro, useUniDirective } from '@windwalker-io/unicorn-next';\nimport { Collapse } from 'bootstrap';\n\nlet nexus: NexusTheme;\n\nexport function useNexusTheme() {\n  nexus ??= new NexusTheme().init();\n\n  return nexus;\n}\n\nclass NexusTheme {\n  init() {\n    domready(() => {\n      this.initRipple();\n      this.initSidebarToggle();\n      this.initSidebarMenu();\n      this.initFullscreen();\n    });\n\n    useMacro('logout', async (url: string, data?: any) => {\n      if (!url) {\n        throw new Error('Please provide logout URL.');\n      }\n\n      const form = await useFormAsync();\n      return form.post(url, data);\n    });\n\n    return this;\n  }\n\n  initRipple() {\n    if (!window.Ribble) {\n      return;\n    }\n\n    useUniDirective('ripple', {\n      mounted(el, { value }) {\n        if (value) {\n          value = JSON.parse(value);\n        } else {\n          value = undefined;\n        }\n\n        Ribble.attachEvent(el, value);\n      }\n    });\n\n    const buttons = document.querySelector('#admin-toolbar')\n      ?.querySelectorAll<HTMLAnchorElement | HTMLButtonElement>('a, button') || [];\n\n    for (const button of buttons) {\n      Ribble.attachEvent(button);\n    }\n  }\n\n  initSidebarToggle() {\n    const toggler = document.querySelector('[data-nx-toggle=\"sidebar\"]');\n\n    toggler?.addEventListener('click', () => {\n      if (window.innerWidth <= 991) {\n        document.body.classList.remove('sidebar-collapsed');\n        document.body.classList.toggle('sidebar-enabled');\n      } else {\n        document.body.classList.remove('sidebar-enabled');\n        document.body.classList.toggle('sidebar-collapsed');\n      }\n    });\n  }\n\n  initSidebarMenu() {\n    const menuButtons = document.querySelectorAll<HTMLDivElement>('.l-sidebar .dropdown-toggle');\n\n    for (const menuButton of menuButtons) {\n      const menu = menuButton.closest('.dropdown')?.querySelector('.dropdown-menu');\n\n      if (!menu) {\n        continue;\n      }\n\n      const menuCollapse = Collapse.getOrCreateInstance(menu, { toggle: false });\n\n      menuButton.addEventListener('click', () => {\n        const show = menuButton.classList.toggle('show');\n\n        if (show) {\n          menuCollapse.show();\n        } else {\n          menuCollapse.hide();\n        }\n      });\n    }\n  }\n\n  initFullscreen() {\n    const fullScreenButtons = document.querySelectorAll<HTMLAnchorElement | HTMLButtonElement>('[data-nx-toggle=fullscreen]');\n\n    for (const fullScreenButton of fullScreenButtons) {\n      fullScreenButton.addEventListener('click', () => {\n        if (!document.fullscreenElement) {\n          let el: HTMLElement | null = document.body;\n\n          if (fullScreenButton.dataset.bsTarget) {\n            el = document.querySelector(fullScreenButton.dataset.bsTarget);\n          }\n\n          if (el) {\n            el.requestFullscreen?.()\n            || el.mozRequestFullscreen?.()\n            || el.webkitRequestFullscreen?.();\n          }\n        } else {\n          document.cancelFullscreen?.()\n          || document.mozCancelFullScreen?.()\n          || document.webkitCancelFullScreen?.();\n        }\n      });\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElement {\n    mozRequestFullscreen?: Function;\n    webkitRequestFullscreen?: Function;\n  }\n\n  interface Document {\n    cancelFullscreen?: Function;\n    mozCancelFullScreen?: Function;\n    webkitCancelFullScreen?: Function;\n  }\n}\n\ndeclare module '@windwalker-io/unicorn-next' {\n  export interface UnicornApp {\n    logout: (url: string, data?: any) => Promise<boolean>;\n  }\n}\n"]}